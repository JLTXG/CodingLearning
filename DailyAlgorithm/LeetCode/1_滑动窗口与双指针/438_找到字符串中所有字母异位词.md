æœ¬æ–‡é¢˜è§£åŸºäºä»¥ä¸‹åŸé¢˜æ•´ç†ï¼Œé¢˜æ„ç»æœ¬äººé‡æ–°è¡¨è¿°ï¼Œè§£é¢˜æ€è·¯ä¸ä»£ç å‡ä¸ºåŸåˆ›æˆ–è½¬è½½ï¼Œä»…ç”¨äºä¸ªäººå­¦ä¹ ä¸äº¤æµï¼Œå®Œæ•´é¢˜ç›®è¯·åŠ¡å¿…æŸ¥é˜…å®˜æ–¹åŸé¢˜é“¾æ¥ï¼š[438. æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/find-all-anagrams-in-a-string/description/?envType=study-plan-v2&envId=top-100-liked)

>æ ‡ç­¾ï¼šå“ˆå¸Œè¡¨  |  å­—ç¬¦ä¸²  |  æ»‘åŠ¨çª—å£

# ä¸€ã€é¢˜ç›®æè¿°

## **é—®é¢˜æ¦‚æ‹¬**

ç»™å®šä¸¤ä¸ªä»…åŒ…å«å°å†™å­—æ¯çš„å­—ç¬¦ä¸² `s` å’Œ `p`ï¼Œè¯·æ‰¾å‡º `s` ä¸­æ‰€æœ‰ä¸ `p` äº’ä¸º**å­—æ¯å¼‚ä½è¯**ï¼ˆå³å­—ç¬¦ç§ç±»å’Œæ•°é‡å®Œå…¨ç›¸åŒï¼Œä½†é¡ºåºå¯ä»¥ä¸åŒï¼‰çš„è¿ç»­å­ä¸²ï¼Œå¹¶è¿”å›è¿™äº›å­ä¸²çš„èµ·å§‹ç´¢å¼•ã€‚ç»“æœå¯ä»¥ä»¥ä»»æ„é¡ºåºè¿”å›ã€‚

## **ç¤ºä¾‹è¯´æ˜**

- **ç¤ºä¾‹1**ï¼š`s = "cbaebabacd"`, `p = "abc"`ï¼Œè¾“å‡º `[0,6]`ã€‚å› ä¸ºå­ä¸² `"cba"`ï¼ˆèµ·å§‹ç´¢å¼•0ï¼‰å’Œ `"bac"`ï¼ˆèµ·å§‹ç´¢å¼•6ï¼‰éƒ½æ˜¯ `"abc"` çš„å­—æ¯å¼‚ä½è¯ã€‚
- **ç¤ºä¾‹2**ï¼š`s = "abab"`, `p = "ab"`ï¼Œè¾“å‡º `[0,1,2]`ã€‚å› ä¸ºå­ä¸² `"ab"`ï¼ˆç´¢å¼•0ï¼‰ã€`"ba"`ï¼ˆç´¢å¼•1ï¼‰å’Œ `"ab"`ï¼ˆç´¢å¼•2ï¼‰éƒ½æ˜¯ `"ab"` çš„å­—æ¯å¼‚ä½è¯ã€‚

## **æ•°æ®èŒƒå›´**

- `1 <= s.length, p.length <= 3 * 10^4`



# äºŒã€è§£é¢˜æ€è·¯\è§£é¢˜è¿‡ç¨‹

## ğŸ”‘ è§£é¢˜æ ¸å¿ƒæ€æƒ³ï¼š**æ»‘åŠ¨çª—å£ + å­—ç¬¦é¢‘æ¬¡ç»Ÿè®¡**

### âœ… ä¸ºä»€ä¹ˆä¸ç”¨æ’åºï¼Ÿ

- æ’åºåˆ¤æ–­å¼‚ä½è¯çš„æ—¶é—´å¤æ‚åº¦ä¸º O(k log k)ï¼Œåœ¨æ»‘åŠ¨çª—å£ä¸­é‡å¤æ‰§è¡Œä¼šå¯¼è‡´æ•´ä½“å¤æ‚åº¦é«˜è¾¾ O(nk log k)ï¼Œ**ä¼šè¶…æ—¶**ã€‚
- **æ­£ç¡®åšæ³•**ï¼šåˆ©ç”¨â€œå¼‚ä½è¯ â‡¨ å­—ç¬¦é¢‘æ¬¡å®Œå…¨ç›¸åŒâ€è¿™ä¸€æ€§è´¨ï¼Œç”¨**å›ºå®šé•¿åº¦çš„é¢‘æ¬¡æ•°ç»„**ä»£æ›¿æ’åºã€‚

---

## ğŸ§  ç®—æ³•æ­¥éª¤è¯¦è§£

### æ­¥éª¤ 1ï¼šè¾¹ç•Œå¤„ç†

- è‹¥ `p` æ¯” `s` é•¿ï¼Œç›´æ¥è¿”å›ç©ºåˆ—è¡¨ã€‚

### æ­¥éª¤ 2ï¼šç»Ÿè®¡æ¨¡å¼ä¸² `p` çš„å­—ç¬¦é¢‘æ¬¡

- ä½¿ç”¨é•¿åº¦ä¸º 26 çš„æ•´å‹æ•°ç»„ `pCount`ï¼ˆå‡è®¾åªå«å°å†™å­—æ¯ï¼‰ã€‚
- éå† `p`ï¼Œå¯¹æ¯ä¸ªå­—ç¬¦ `c` æ‰§è¡Œï¼š`pCount[c - 'a']++`

### æ­¥éª¤ 3ï¼šåˆå§‹åŒ–ç¬¬ä¸€ä¸ªæ»‘åŠ¨çª—å£ `[0, k-1]`

- åˆ›å»º `windowCount` æ•°ç»„ï¼Œç»Ÿè®¡ `s` å‰ `k` ä¸ªå­—ç¬¦çš„é¢‘æ¬¡ã€‚

### æ­¥éª¤ 4ï¼šæ£€æŸ¥åˆå§‹çª—å£æ˜¯å¦åŒ¹é…

- ä½¿ç”¨ `Arrays.equals(pCount, windowCount)` åˆ¤æ–­æ˜¯å¦ä¸ºå¼‚ä½è¯ã€‚
- å¦‚æœæ˜¯ï¼Œå°†èµ·å§‹ç´¢å¼• `0` åŠ å…¥ç»“æœã€‚

### æ­¥éª¤ 5ï¼šæ»‘åŠ¨çª—å£å‘å³ç§»åŠ¨

- ä» `right = k` å¼€å§‹ï¼Œæ¯æ¬¡ï¼š
    1. **åŠ å…¥æ–°å­—ç¬¦**ï¼š`s[right]` â†’ `windowCount[s[right] - 'a']++`
    2. **ç§»é™¤æ—§å­—ç¬¦**ï¼š`s[right - k]` â†’ `windowCount[s[right - k] - 'a']--`
    3. **æ£€æŸ¥å½“å‰çª—å£** `[right - k + 1, right]` æ˜¯å¦åŒ¹é…
    4. è‹¥åŒ¹é…ï¼Œè®°å½•èµ·å§‹ç´¢å¼• `right - k + 1`

---

## â±ï¸ å¤æ‚åº¦åˆ†æ

| é¡¹ç›®           | å¤æ‚åº¦                                                       |
| -------------- | ------------------------------------------------------------ |
| **æ—¶é—´å¤æ‚åº¦** | **O(n)**  <br>â€¢ åˆå§‹åŒ–çª—å£ï¼šO(k)  <br>â€¢ æ»‘åŠ¨è¿‡ç¨‹ï¼šO(n - k)  <br>â€¢ æ¯æ¬¡æ¯”è¾ƒæ•°ç»„ï¼šO(26) = O(1) |
| **ç©ºé—´å¤æ‚åº¦** | **O(1)**  <br>â€¢ ä¸¤ä¸ªå›ºå®šå¤§å°ï¼ˆ26ï¼‰çš„æ•°ç»„ï¼Œä¸éšè¾“å…¥å¢é•¿       |

> ğŸ’¡ å³ä½¿æ‰©å±•åˆ° Unicodeï¼Œä¹Ÿå¯ç”¨ `HashMap`ï¼Œä½†æœ¬é¢˜é™å®šå°å†™å­—æ¯ï¼Œæ•°ç»„æœ€ä¼˜ã€‚

---

## ğŸŒ° ç¤ºä¾‹æ¼”ç¤ºï¼ˆs = "cbaebabacd", p = "abc"ï¼‰

| çª—å£ä½ç½® | å­ä¸²  | windowCount   | æ˜¯å¦åŒ¹é…       |
| -------- | ----- | ------------- | -------------- |
| [0,2]    | "cba" | a:1, b:1, c:1 | âœ… æ˜¯ â†’ index 0 |
| [1,3]    | "bae" | a:1, b:1, e:1 | âŒ å¦           |
| [2,4]    | "aeb" | ...           | âŒ              |
| [3,5]    | "eba" | ...           | âŒ              |
| [4,6]    | "bab" | b:2, a:1      | âŒ              |
| [5,7]    | "aba" | a:2, b:1      | âŒ              |
| [6,8]    | "bac" | a:1, b:1, c:1 | âœ… æ˜¯ â†’ index 6 |
| [7,9]    | "acd" | ...           | âŒ              |

âœ… ç»“æœï¼š`[0, 6]`

---

## âš ï¸ å…³é”®ç»†èŠ‚ & æ˜“é”™ç‚¹

| é—®é¢˜             | è¯´æ˜                                                         |
| ---------------- | ------------------------------------------------------------ |
| **å­—ç¬¦èŒƒå›´**     | æœ¬é¢˜ä¿è¯åªå«å°å†™å­—æ¯ï¼Œæ‰€ä»¥ç”¨ `c - 'a'` å®‰å…¨ï¼›è‹¥å«å…¶ä»–å­—ç¬¦ï¼Œéœ€æ”¹ç”¨ `HashMap` |
| **æ•°ç»„æ¯”è¾ƒ**     | å¿…é¡»ç”¨ `Arrays.equals(arr1, arr2)`ï¼Œä¸èƒ½ç›´æ¥ `==` æˆ– `arr1.equals(arr2)` |
| **çª—å£ç§»åŠ¨é€»è¾‘** | å…ˆåŠ æ–°å­—ç¬¦ï¼Œå†åˆ æ—§å­—ç¬¦ï¼Œé¡ºåºä¸èƒ½å                           |
| **èµ·å§‹ç´¢å¼•è®¡ç®—** | å½“å‰çª—å£ä¸º `[right - k + 1, right]`ï¼Œèµ·å§‹ç´¢å¼•æ˜¯ `right - k + 1` |

---

## ğŸ› ï¸ æ‰©å±•æ€è€ƒ

### å¦‚æœå­—ç¬¦ä¸²åŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—ç­‰ï¼Ÿ

â†’ æ”¹ç”¨ `HashMap<Character, Integer>` ç»Ÿè®¡é¢‘æ¬¡ã€‚

### èƒ½å¦é¿å…æ¯æ¬¡æ¯”è¾ƒæ•´ä¸ªæ•°ç»„ï¼Ÿ

â†’ å¯ä»¥ç»´æŠ¤ä¸€ä¸ª `diff` å˜é‡è®°å½•ä¸åŒå­—ç¬¦ç§ç±»æ•°ï¼Œå®ç°**ä¸¥æ ¼ O(1) æ¯”è¾ƒ**ï¼Œä½†ä»£ç æ›´å¤æ‚ï¼Œé€šå¸¸æ²¡å¿…è¦ï¼ˆ26 å¾ˆå°ï¼‰ã€‚

---

## âœ… ä¸€å¥è¯æ€»ç»“

> **ç”¨å›ºå®šå¤§å°çš„æ»‘åŠ¨çª—å£ç»´æŠ¤å­—ç¬¦é¢‘æ¬¡ï¼Œé€šè¿‡é¢‘æ¬¡æ•°ç»„ç›¸ç­‰æ€§åˆ¤æ–­å¼‚ä½è¯ï¼Œå®ç° O(n) é«˜æ•ˆæ±‚è§£ã€‚**



# ä¸‰ã€ä»£ç æ¼”ç¤º

## Javaä»£ç 

```Java
class Solution {
    public List<Integer> findAnagrams(String s, String p) {
        List<Integer> result = new ArrayList<>();
        char[] arrS = s.toCharArray(), arrP = p.toCharArray();
        int n = arrS.length, k = arrP.length;
        if (k > n) return result;
        // ç»Ÿè®¡ p ä¸­æ¯ä¸ªå­—ç¬¦çš„é¢‘æ¬¡
        int[] pCount = new int[26];
        for (char c : arrP) {
            pCount[c - 'a']++;
        }

        int[] windowCount = new int[26];
        for (int i = 0; i < n; i++) {
            windowCount[arrS[i] - 'a']++;

            int left = i - k + 1;
            if (left < 0) {
                continue;
            }
            if (Arrays.equals(pCount, windowCount)) {
                result.add(left);
            }

            windowCount[arrS[left] - 'a']--;
        }

        return result;
    }
}
```

![438_æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯_Java](https://gitee.com/lei-weijun/CodingLearning/raw/main/DailyAlgorithm/LeetCode/1_%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E4%B8%8E%E5%8F%8C%E6%8C%87%E9%92%88/Images/438_%E6%89%BE%E5%88%B0%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E6%89%80%E6%9C%89%E5%AD%97%E6%AF%8D%E5%BC%82%E4%BD%8D%E8%AF%8D_Java.png)

## Pythonä»£ç 

```Python
class Solution:
    def findAnagrams(self, s: str, p: str) -> List[int]:
        result = []
        n, k = len(s), len(p)
        if k > n:
            return result
        p_count = [0] * 26
        for i in p:
            p_count[ord(i) - ord('a')] += 1
        
        window_count = [0] * 26
        for i in range(n):
            window_count[ord(s[i]) - ord('a')] += 1

            left = i - k + 1
            if left < 0:
                continue
            if p_count == window_count:
                result.append(left)
            
            window_count[ord(s[left]) - ord('a')] -= 1
        
        return result
```



## C++ä»£ç 

```C++
class Solution {
public:
    vector<int> findAnagrams(string s, string p) {
        vector<int> result;
        int n = s.size(), k = p.size();
        if (k > n) return result;
        vector<int> pCount(26);
        for (int i = 0; i < k; i++) {
            pCount[p[i] - 'a']++;
        }
        vector<int> windowCount(26);
        for (int i = 0; i < n; i++) {
            windowCount[s[i] - 'a']++;

            int left = i - k + 1;
            if (left < 0) {
                continue;
            }
            if (pCount == windowCount) {
                result.push_back(left);
            }

            windowCount[s[left] - 'a']--;
        }
        return result;
    }
};
```

