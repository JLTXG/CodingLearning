æœ¬æ–‡é¢˜è§£åŸºäºä»¥ä¸‹åŸé¢˜æ•´ç†ï¼Œé¢˜æ„ç»æœ¬äººé‡æ–°è¡¨è¿°ï¼Œè§£é¢˜æ€è·¯ä¸ä»£ç å‡ä¸ºåŸåˆ›æˆ–è½¬è½½ï¼Œä»…ç”¨äºä¸ªäººå­¦ä¹ ä¸äº¤æµï¼Œå®Œæ•´é¢˜ç›®è¯·åŠ¡å¿…æŸ¥é˜…å®˜æ–¹åŸé¢˜é“¾æ¥ï¼š[238. é™¤äº†è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/product-of-array-except-self/description/?envType=study-plan-v2&envId=top-100-liked)

>æ ‡ç­¾ï¼šæ•°ç»„  |  å‰ç¼€å’Œ

# ä¸€ã€é¢˜ç›®æè¿°

## **é—®é¢˜æ¦‚æ‹¬**

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums`ï¼Œè¯·æ„é€ ä¸€ä¸ªæ•°ç»„ `answer`ï¼Œä½¿å¾—å¯¹äºæ¯ä¸ªä¸‹æ ‡ `i`ï¼Œ`answer[i]` ç­‰äº `nums` ä¸­é™¤ `nums[i]` å¤–æ‰€æœ‰å…¶ä»–å…ƒç´ çš„ä¹˜ç§¯ã€‚è¦æ±‚ä¸èƒ½ä½¿ç”¨é™¤æ³•ï¼Œä¸”ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åº”ä¸º **O(n)**ã€‚

## **ç¤ºä¾‹è¯´æ˜**

- **ç¤ºä¾‹1**ï¼š`nums = [1,2,3,4]`ï¼Œè¾“å‡º `[24,12,8,6]`ã€‚
- **ç¤ºä¾‹2**ï¼š`nums = [-1,1,0,-3,3]`ï¼Œè¾“å‡º `[0,0,9,0,0]`ã€‚

## **æ•°æ®èŒƒå›´**

- `2 <= nums.length <= 10^5`
- `-30 <= nums[i] <= 30`
- ä¿è¯è¾“å‡ºç»“æœåœ¨ 32 ä½æ•´æ•°èŒƒå›´å†…

## **è¿›é˜¶æŒ‘æˆ˜**

èƒ½å¦åœ¨ **O(1)** é¢å¤–ç©ºé—´å¤æ‚åº¦å†…å®Œæˆæ­¤é¢˜ï¼Ÿï¼ˆè¾“å‡ºæ•°ç»„ä¸è®¡å…¥é¢å¤–ç©ºé—´ï¼‰



# äºŒã€è§£é¢˜æ€è·¯\è§£é¢˜è¿‡ç¨‹

## ğŸ”‘ æ ¸å¿ƒæ€æƒ³ï¼š**å‰ç¼€ç§¯ Ã— åç¼€ç§¯**

å¯¹äºæ¯ä¸ªä½ç½® `i`ï¼Œ`answer[i] = (nums[0] Ã— ... Ã— nums[i-1]) Ã— (nums[i+1] Ã— ... Ã— nums[n-1])`

- **å‰ç¼€ç§¯ `pre[i]`**ï¼šä»å·¦åˆ°å³ç´¯ç§¯
- **åç¼€ç§¯ `sub[i]`**ï¼šä»å³åˆ°å·¦ç´¯ç§¯

> ğŸ’¡ è¿™æ˜¯â€œé™¤äº†è‡ªèº«ä»¥å¤–çš„ä¹˜ç§¯â€é—®é¢˜çš„ç»å…¸æ‹†è§£æ–¹å¼ã€‚

---

## âš™ï¸ ç®—æ³•æ­¥éª¤

1. **åˆå§‹åŒ–**ï¼š
    - `pre[0] = 1`ï¼ˆå·¦è¾¹æ— å…ƒç´ ï¼‰
    - `sub[n-1] = 1`ï¼ˆå³è¾¹æ— å…ƒç´ ï¼‰
2. **ä¸€æ¬¡éå†åŒæ—¶è®¡ç®— `pre` å’Œ `sub`**ï¼ˆä½ ç”¨äº†å·§å¦™çš„å¯¹ç§°ç´¢å¼•ï¼‰
3. **åˆå¹¶ç»“æœ**ï¼š`result[i] = pre[i] * sub[i]`

---

## ğŸ§ª ä¸¾ä¾‹éªŒè¯ï¼ˆnums = [1,2,3,4]ï¼‰

| i    | nums[i] | pre[i]  | sub[i]   | result[i] |
| ---- | ------- | ------- | -------- | --------- |
| 0    | 1       | 1       | 2Ã—3Ã—4=24 | 24        |
| 1    | 2       | 1       | 3Ã—4=12   | 12        |
| 2    | 3       | 1Ã—2=2   | 4        | 8         |
| 3    | 4       | 1Ã—2Ã—3=6 | 1        | 6         |

âœ… è¾“å‡ºï¼š`[24, 12, 8, 6]`ï¼Œæ­£ç¡®ï¼

---

## â±ï¸ å¤æ‚åº¦åˆ†æ

| é¡¹ç›® | å¤æ‚åº¦                |
| ---- | --------------------- |
| æ—¶é—´ | O(n)                  |
| ç©ºé—´ | O(n)ï¼ˆ`pre` + `sub`ï¼‰ |

> ğŸ“Œ **è¿›é˜¶ä¼˜åŒ–æ–¹å‘**ï¼š  
> å¯ä»¥**ç›´æ¥ç”¨ `result` æ•°ç»„å…ˆå­˜å‰ç¼€ç§¯**ï¼Œå†ç”¨ä¸€ä¸ªå˜é‡ä»å³å¾€å·¦ç´¯ç§¯åç¼€ç§¯å¹¶ç›¸ä¹˜ï¼Œä»è€Œçœå» `sub` æ•°ç»„ï¼Œè¾¾åˆ° O(1) ç©ºé—´ã€‚

---

## â— æ˜“é”™ç‚¹æé†’

- **ä¸è¦ç”¨é™¤æ³•**ï¼šå³ä½¿ `product / nums[i]` çœ‹èµ·æ¥ç®€å•ï¼Œä½† `nums[i]` å¯èƒ½ä¸º 0ï¼Œä¸”é¢˜ç›®æ˜ç¡®ç¦æ­¢ã€‚
- **è¾¹ç•Œåˆå§‹åŒ–**ï¼š`pre[0]` å’Œ `sub[n-1]` å¿…é¡»è®¾ä¸º 1ã€‚
- **åç¼€ç§¯ç´¢å¼•**ï¼šä½ ç”¨ `n - i - 1` å’Œ `n - i` æ˜¯æ­£ç¡®çš„ï¼Œä½†å®¹æ˜“å†™é”™ï¼Œéœ€ä»”ç»†éªŒè¯ã€‚

---

# ä¸‰ã€ä»£ç æ¼”ç¤º

## Javaä»£ç 

```Java
// åŸç‰ˆä»£ç 
class Solution {
    public int[] productExceptSelf(int[] nums) {
        int n = nums.length;
        int[] pre = new int[n];
        int[] sub = new int[n];
        int[] result = new int[n];
        pre[0] = 1;
        sub[n - 1] = 1;
        for (int i = 1, j = n - 2; i < n && j >= 0; i++, j--) {
            pre[i] = pre[i - 1] * nums[i - 1];
            sub[j] = sub[j + 1] * nums[j + 1];
        }
        for (int i = 0; i < n; i++) {
            result[i] = pre[i] * sub[i];
        }
        return result;
    }
}

// è¿›é˜¶ä»£ç 
class Solution {
    public int[] productExceptSelf(int[] nums) {
        int n = nums.length;
        int[] result = new int[n];
        Arrays.fill(result, 1);
        for (int i = 1; i < n; i++) {
            result[i] = result[i - 1] * nums[i - 1];
        }
        int right = 1;
        for (int i = n - 1; i >= 0; i--) {
            result[i] *= right;
            right *= nums[i];
        }
        return result;
    }
}
```



## Pythonä»£ç 

```Python
# åŸç‰ˆä»£ç 
class Solution:
    def productExceptSelf(self, nums: List[int]) -> List[int]:
        n = len(nums)
        pre, sub, result = [0] * n, [0] * n, [0] * n 
        pre[0] = sub[n - 1] = 1
        for i in range(1, n):
            pre[i] = pre[i - 1] * nums[i - 1]
            sub[n - i - 1] = sub[n - i] * nums[n - i]
        for i in range(n):
            result[i] = pre[i] * sub[i]
        return result

# è¿›é˜¶ä»£ç 
class Solution:
    def productExceptSelf(self, nums: List[int]) -> List[int]:
        n = len(nums)
        # ç›´æ¥ç”¨ result æ•°ç»„å­˜å‚¨å‰ç¼€ç§¯ï¼ˆä½œä¸ºè¾“å‡ºæ•°ç»„ï¼Œä¸è®¡å…¥é¢å¤–ç©ºé—´ï¼‰
        result = [1] * n

        # ç¬¬ä¸€æ­¥ï¼šè®¡ç®—å‰ç¼€ç§¯ï¼Œå­˜å…¥ result
        # result[i] = nums[0] * nums[1] * ...... * nums[i - 1]
        for i in range(1, n):
            result[i] = result[i - 1] * nums[i - 1]
        
        # ç¬¬äºŒæ­¥ï¼šä»å³å¾€å·¦éå†ï¼Œç”¨ä¸€ä¸ªå˜é‡ right ç´¯ç§¯åç¼€ç§¯
        # å¹¶ç›´æ¥ä¹˜åˆ° result[i] ä¸Š
        right = 1  # è¡¨ç¤ºå½“å‰ä½ç½®å³è¾¹æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯
        for i in range(n - 1, -1, -1):
            result[i] *= right  # result[i] = å‰ç¼€ç§¯ * åç¼€ç§¯
            right *= nums[i]    # æ›´æ–°åç¼€ç§¯ï¼šåŠ å…¥å½“å‰ nums[i]
        
        return result
```



## C++ä»£ç 

```C++
// åŸç‰ˆä»£ç 
class Solution {
public:
    vector<int> productExceptSelf(vector<int>& nums) {
        int n = nums.size();
        vector<int> pre(n);
        vector<int> sub(n);
        vector<int> result(n);
        pre[0] = 1;
        sub[n - 1] = 1;
        for (int i = 1, j = n - 2; i < n && j >= 0; i++, j--) {
            pre[i] = pre[i - 1] * nums[i - 1];
            sub[j] = sub[j + 1] * nums[j + 1];
        }
        for (int i = 0; i < n; i++) {
            result[i] = pre[i] * sub[i];
        }
        return result;
    }
};

// è¿›é˜¶ä»£ç 
class Solution {
public:
    vector<int> productExceptSelf(vector<int>& nums) {
        int n = nums.size();
        vector<int> result(n, 1);
        for (int i = 1; i < n; i++) {
            result[i] = result[i - 1] * nums[i - 1];
        }
        int right = 1;
        for (int i = n - 1; i >= 0; i--) {
            result[i] *= right;
            right *= nums[i];
        }
        return result;
    }
};
```

![238_é™¤äº†è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯_C++](https://gitee.com/lei-weijun/CodingLearning/raw/main/DailyAlgorithm/LeetCode/8_%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/Images/238_%E9%99%A4%E4%BA%86%E8%87%AA%E8%BA%AB%E4%BB%A5%E5%A4%96%E6%95%B0%E7%BB%84%E7%9A%84%E4%B9%98%E7%A7%AF_C++.png)