æœ¬æ–‡é¢˜è§£åŸºäºä»¥ä¸‹åŸé¢˜æ•´ç†ï¼Œé¢˜æ„ç»æœ¬äººé‡æ–°è¡¨è¿°ï¼Œè§£é¢˜æ€è·¯ä¸ä»£ç å‡ä¸ºåŸåˆ›æˆ–è½¬è½½ï¼Œä»…ç”¨äºä¸ªäººå­¦ä¹ ä¸äº¤æµï¼Œå®Œæ•´é¢˜ç›®è¯·åŠ¡å¿…æŸ¥é˜…å®˜æ–¹åŸé¢˜é“¾æ¥ï¼š[560. å’Œä¸º K çš„å­æ•°ç»„ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/subarray-sum-equals-k/description/?envType=study-plan-v2&envId=top-100-liked)

>æ ‡ç­¾ï¼šæ•°ç»„  |  å“ˆå¸Œè¡¨  |  å‰ç¼€å’Œ

# ä¸€ã€é¢˜ç›®æè¿°

## **é—®é¢˜æ¦‚æ‹¬**

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å€¼ `k`ï¼Œè¯·ç»Ÿè®¡æ•°ç»„ä¸­æ‰€æœ‰**è¿ç»­éç©ºå­æ•°ç»„**ï¼ˆå³æ•°ç»„ä¸­ä¸€æ®µè¿ç»­çš„å…ƒç´ åºåˆ—ï¼‰ä¸­ï¼Œå…ƒç´ ä¹‹å’Œæ°å¥½ç­‰äº `k` çš„å­æ•°ç»„ä¸ªæ•°ã€‚

## **ç¤ºä¾‹è¯´æ˜**

- **ç¤ºä¾‹1**ï¼š`nums = [1,1,1]`, `k = 2`ï¼Œå’Œä¸º 2 çš„å­æ•°ç»„æœ‰ `[1,1]`ï¼ˆå‰ä¸¤ä¸ªï¼‰å’Œ `[1,1]`ï¼ˆåä¸¤ä¸ªï¼‰ï¼Œå…± 2 ä¸ªã€‚
- **ç¤ºä¾‹2**ï¼š`nums = [1,2,3]`, `k = 3`ï¼Œå’Œä¸º 3 çš„å­æ•°ç»„æœ‰ `[1,2]` å’Œ `[3]`ï¼Œå…± 2 ä¸ªã€‚

## **æ•°æ®èŒƒå›´**

- `1 <= nums.length <= 2 * 10^4`
- `-1000 <= nums[i] <= 1000`
- `-10^7 <= k <= 10^7`



# äºŒã€è§£é¢˜æ€è·¯\è§£é¢˜è¿‡ç¨‹

## ğŸ“Œ é¢˜ç›®ç›®æ ‡

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªæ•´æ•° `k`ï¼Œ
**æ±‚å’Œä¸º `k` çš„è¿ç»­å­æ•°ç»„çš„ä¸ªæ•°**ã€‚  

> æ³¨æ„ï¼šæ•°ç»„ä¸­å¯èƒ½åŒ…å« **è´Ÿæ•°**ï¼

------

## ğŸ”‘ æ ¸å¿ƒæ€æƒ³ï¼š**å‰ç¼€å’Œ + å“ˆå¸Œè¡¨**

### 1ï¸âƒ£ ä»€ä¹ˆæ˜¯å‰ç¼€å’Œï¼Ÿ

- `prefix[i] = nums[0] + nums[1] + ... + nums[i-1]`
- å­æ•°ç»„ `nums[i...j]` çš„å’Œ = `prefix[j+1] - prefix[i]`

### 2ï¸âƒ£ è½¬åŒ–é—®é¢˜

æˆ‘ä»¬å¸Œæœ›ï¼š

```
nums[i] + ... + nums[j] == k
â‡” prefix[j+1] - prefix[i] == k
â‡” prefix[i] == prefix[j+1] - k
```

ğŸ‘‰ æ‰€ä»¥ï¼Œ**éå†åˆ°ä½ç½® j æ—¶ï¼Œåªéœ€çŸ¥é“ï¼šåœ¨ j ä¹‹å‰æœ‰å¤šå°‘ä¸ªå‰ç¼€å’Œç­‰äº `current_prefix - k`**ã€‚

### 3ï¸âƒ£ ç”¨å“ˆå¸Œè¡¨ä¼˜åŒ–

- ç”¨å“ˆå¸Œè¡¨ `map` è®°å½•ï¼š**æ¯ä¸ªå‰ç¼€å’Œå‡ºç°çš„æ¬¡æ•°**
- éå†è¿‡ç¨‹ä¸­ï¼š
    - è®¡ç®—å½“å‰å‰ç¼€å’Œ `prefix`
    - æŸ¥è¯¢ `map[prefix - k]`ï¼Œç´¯åŠ åˆ°ç­”æ¡ˆ
    - å°†å½“å‰ `prefix` åŠ å…¥å“ˆå¸Œè¡¨

### 4ï¸âƒ£ å…³é”®ç»†èŠ‚ï¼šåˆå§‹åŒ– `map{0: 1}`

- è¡¨ç¤ºâ€œç©ºå‰ç¼€â€çš„å’Œä¸º 0ï¼Œå‡ºç° 1 æ¬¡
- ä½œç”¨ï¼šå½“æŸä¸ªå­æ•°ç»„ä» `nums[0]` å¼€å§‹ä¸”å’Œä¸º `k` æ—¶ï¼Œèƒ½è¢«æ­£ç¡®è®¡æ•°
    ï¼ˆä¾‹å¦‚ `nums = [1,2,3], k=3` â†’ `[1,2]` å’Œä¸º 3ï¼Œæ­¤æ—¶ `prefix=3`, `prefix - k = 0`ï¼Œéœ€è¦ map[0]=1ï¼‰

------

## ğŸ§® ç®—æ³•æ­¥éª¤ï¼ˆä¼ªä»£ç ï¼‰

```text
åˆå§‹åŒ–å“ˆå¸Œè¡¨ map = {0: 1}
prefix = 0, count = 0

for num in nums:
    prefix += num
    count += map.get(prefix - k, 0)
    map[prefix] += 1

return count
```

------

## â±ï¸ å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼šO(n) â€”â€” ä¸€æ¬¡éå†
- **ç©ºé—´å¤æ‚åº¦**ï¼šO(n) â€”â€” å“ˆå¸Œè¡¨æœ€å¤šå­˜ n+1 ä¸ªå‰ç¼€å’Œ

------

## ğŸ’¡ ä¸ºä»€ä¹ˆä¸èƒ½ç”¨æ»‘åŠ¨çª—å£ï¼Ÿ

- æ»‘åŠ¨çª—å£è¦æ±‚ **å…ƒç´ éè´Ÿ**ï¼ˆä¿è¯çª—å£æ‰©å¤§/ç¼©å°å•è°ƒï¼‰
- æœ¬é¢˜å« **è´Ÿæ•°**ï¼Œçª—å£å’Œä¸å…·æœ‰å•è°ƒæ€§ â†’ âŒ ä¸é€‚ç”¨

------

## âœ… ä¸€å¥è¯æ€»ç»“

> åˆ©ç”¨å‰ç¼€å’Œå°†å­æ•°ç»„å’Œé—®é¢˜è½¬åŒ–ä¸ºâ€œæŸ¥æ‰¾å†å²å‰ç¼€å’Œâ€çš„é—®é¢˜ï¼Œé€šè¿‡å“ˆå¸Œè¡¨å®ç° O(1) æŸ¥è¯¢ï¼Œä»è€Œåœ¨ O(n) æ—¶é—´å†…é«˜æ•ˆæ±‚è§£ã€‚

------



# ä¸‰ã€ä»£ç æ¼”ç¤º

## Javaä»£ç 

```Java
class Solution {
    public int subarraySum(int[] nums, int k) {
        Map<Integer, Integer> prefixCount = new HashMap<>();
        // å‰ç¼€å’Œä¸º0çš„å‡ºç°1æ¬¡ï¼ˆç©ºæ•°ç»„ï¼‰
        prefixCount.put(0, 1);

        int prefix = 0, count = 0;
        for (int num : nums) {
            prefix += num;
            // æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨å‰ç¼€å’Œ = prefix - k
            count += prefixCount.getOrDefault(prefix -k, 0);
            // æ›´æ–°å½“å‰å‰ç¼€å’Œçš„å‡ºç°æ¬¡æ•°
            prefixCount.put(prefix, prefixCount.getOrDefault(prefix, 0) + 1);
        }

        return count;
    }
}
```



## Pythonä»£ç 

```python
class Solution:
    def subarraySum(self, nums: List[int], k: int) -> int:
        prefix_count = defaultdict(int)
        # å‰ç¼€å’Œä¸º0çš„å‡ºç°1æ¬¡ï¼ˆç©ºæ•°ç»„ï¼‰
        prefix_count[0] = 1

        prefix, count = 0, 0
        for num in nums:
            prefix += num
            count += prefix_count[prefix - k]
            prefix_count[prefix] += 1
        
        return count
```



## C++ä»£ç 

```C++
class Solution {
public:
    int subarraySum(vector<int>& nums, int k) {
        unordered_map<int, int> prefixCount;
        // å‰ç¼€å’Œä¸º0å‡ºç°1æ¬¡ï¼ˆå¯¹åº”ç©ºå­æ•°ç»„ï¼‰
        prefixCount[0] = 1;

        int prefix = 0, count = 0;

        for (auto num : nums) {
            prefix += num;
            // æŸ¥æ‰¾å½“å‰çš„å‰ç¼€å’Œ = prefix - k
            if (prefixCount.find(prefix - k) != prefixCount.end()) {
                count += prefixCount[prefix - k];
            }
            // æ›´æ–°å½“å‰å‰ç¼€å’Œçš„å‡ºç°æ¬¡æ•°
            prefixCount[prefix]++;
        }

        return count;
    }
};
```

![560_å’Œä¸º K çš„å­æ•°ç»„_C++]()