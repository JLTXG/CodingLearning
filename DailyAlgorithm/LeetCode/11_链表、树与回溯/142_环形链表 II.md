æœ¬æ–‡é¢˜è§£åŸºäºŽä»¥ä¸‹åŽŸé¢˜æ•´ç†ï¼Œé¢˜æ„ç»æœ¬äººé‡æ–°è¡¨è¿°ï¼Œè§£é¢˜æ€è·¯ä¸Žä»£ç å‡ä¸ºåŽŸåˆ›æˆ–è½¬è½½ï¼Œä»…ç”¨äºŽä¸ªäººå­¦ä¹ ä¸Žäº¤æµï¼Œå®Œæ•´é¢˜ç›®è¯·åŠ¡å¿…æŸ¥é˜…å®˜æ–¹åŽŸé¢˜é“¾æŽ¥ï¼š[142. çŽ¯å½¢é“¾è¡¨ II - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/linked-list-cycle-ii/description/?envType=study-plan-v2&envId=top-100-liked)

>æ ‡ç­¾ï¼šå“ˆå¸Œè¡¨  |  é“¾è¡¨  |  åŒæŒ‡é’ˆ

# ä¸€ã€é¢˜ç›®æè¿°

## **é—®é¢˜æ¦‚æ‹¬**

ç»™å®šä¸€ä¸ªå•é“¾è¡¨çš„å¤´èŠ‚ç‚¹ `head`ï¼Œåˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦å­˜åœ¨çŽ¯ã€‚å¦‚æžœå­˜åœ¨çŽ¯ï¼Œè¯·æ‰¾å‡ºå¹¶è¿”å›žçŽ¯çš„èµ·å§‹èŠ‚ç‚¹ï¼ˆå³é“¾è¡¨å°¾èŠ‚ç‚¹æŒ‡å‘çš„é‚£ä¸ªèŠ‚ç‚¹ï¼‰ï¼›å¦‚æžœä¸å­˜åœ¨çŽ¯ï¼Œåˆ™è¿”å›ž `null`ã€‚è¦æ±‚ä¸å¾—ä¿®æ”¹é“¾è¡¨ç»“æž„ã€‚

## **ç¤ºä¾‹è¯´æ˜Ž**

- **ç¤ºä¾‹1**ï¼š`head = [3,2,0,-4]`ï¼ŒçŽ¯çš„å…¥å£æ˜¯ç¬¬äºŒä¸ªèŠ‚ç‚¹ï¼ˆç´¢å¼• 1ï¼‰ï¼Œè¿”å›žè¯¥èŠ‚ç‚¹ã€‚
- **ç¤ºä¾‹2**ï¼š`head = [1,2]`ï¼ŒçŽ¯çš„å…¥å£æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆç´¢å¼• 0ï¼‰ï¼Œè¿”å›žè¯¥èŠ‚ç‚¹ã€‚
- **ç¤ºä¾‹3**ï¼š`head = [1]`ï¼Œæ— çŽ¯ï¼Œè¿”å›ž `null`ã€‚

## **æ•°æ®èŒƒå›´**

- èŠ‚ç‚¹æ•°ç›®èŒƒå›´ `[0, 10^4]`
- èŠ‚ç‚¹å€¼èŒƒå›´ `[-10^5, 10^5]`

## **è¿›é˜¶è¦æ±‚**

èƒ½å¦ä½¿ç”¨ O(1) é¢å¤–ç©ºé—´è§£å†³ï¼Ÿ



# äºŒã€è§£é¢˜æ€è·¯\è§£é¢˜è¿‡ç¨‹

## âœ… å¸¦è¯¦ç»†æ³¨é‡Šçš„ä»£ç 

```java
/**
 * Definition for singly-linked list.
 * class ListNode {
 *     int val;
 *     ListNode next;
 *     ListNode(int x) {
 *         val = x;
 *         next = null;
 *     }
 * }
 */
public class Solution {
    public ListNode detectCycle(ListNode head) {
        // åˆå§‹åŒ–å¿«æ…¢æŒ‡é’ˆï¼Œéƒ½ä»Žå¤´èŠ‚ç‚¹å‡ºå‘
        ListNode fast = head;
        ListNode slow = head;

        // ç¬¬ä¸€é˜¶æ®µï¼šæ£€æµ‹æ˜¯å¦å­˜åœ¨çŽ¯
        while (fast != null && fast.next != null) {
            slow = slow.next;        // æ…¢æŒ‡é’ˆèµ° 1 æ­¥
            fast = fast.next.next;   // å¿«æŒ‡é’ˆèµ° 2 æ­¥

            // å¦‚æžœå¿«æ…¢æŒ‡é’ˆç›¸é‡ï¼Œè¯´æ˜Žå­˜åœ¨çŽ¯
            if (fast == slow) {
                // ç¬¬äºŒé˜¶æ®µï¼šæ‰¾çŽ¯çš„å…¥å£
                // å°†ä¸€ä¸ªæŒ‡é’ˆé‡ç½®åˆ° headï¼Œå¦ä¸€ä¸ªä¿æŒåœ¨ç›¸é‡ç‚¹
                // ä¸¤ä¸ªæŒ‡é’ˆä»¥ç›¸åŒé€Ÿåº¦ï¼ˆæ¯æ¬¡1æ­¥ï¼‰å‰è¿›ï¼Œå†æ¬¡ç›¸é‡å³ä¸ºçŽ¯å…¥å£
                while (slow != head) {
                    slow = slow.next;
                    head = head.next;
                }
                return slow; // æˆ– return headï¼Œä¸¤è€…ç›¸ç­‰
            }
        }

        // å¿«æŒ‡é’ˆåˆ°è¾¾æœ«å°¾ï¼Œè¯´æ˜Žæ— çŽ¯
        return null;
    }
}
```

> ðŸ’¡ æ³¨æ„ï¼šä»£ç ä¸­ç›´æŽ¥ä¿®æ”¹äº† `head`ï¼Œè™½ç„¶ä¸å½±å“æ­£ç¡®æ€§ï¼ˆå› ä¸º Java æ˜¯å€¼ä¼ é€’ï¼‰ï¼Œä½†ä¸ºäº†å¯è¯»æ€§ï¼Œæœ‰äº›äººä¼šç”¨æ–°å˜é‡å¦‚ `ptr = head`ã€‚è¿™é‡Œé€»è¾‘å®Œå…¨æ­£ç¡®ã€‚

------

## ðŸ§  æ ¸å¿ƒè§£é¢˜æ€æƒ³åˆ†æž

### ðŸ” é—®é¢˜ç›®æ ‡ï¼š

- åˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰çŽ¯ï¼›
- å¦‚æžœæœ‰ï¼Œ**è¿”å›žçŽ¯çš„èµ·å§‹èŠ‚ç‚¹ï¼ˆå…¥å£ï¼‰**ã€‚

------

### ðŸ’¡ æ ¸å¿ƒæ€æƒ³ï¼š**Floyd åˆ¤åœˆç®—æ³•ï¼ˆä¸¤é˜¶æ®µï¼‰**

#### é˜¶æ®µä¸€ï¼š**æ£€æµ‹çŽ¯æ˜¯å¦å­˜åœ¨**

- ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆï¼ˆ`fast` èµ° 2 æ­¥ï¼Œ`slow` èµ° 1 æ­¥ï¼‰
- è‹¥æœ‰çŽ¯ï¼ŒäºŒè€…å¿…åœ¨çŽ¯å†…æŸç‚¹ç›¸é‡

#### é˜¶æ®µäºŒï¼š**å®šä½çŽ¯çš„å…¥å£**

- å°†ä¸€ä¸ªæŒ‡é’ˆæ”¾å›ž `head`ï¼Œå¦ä¸€ä¸ªç•™åœ¨ç›¸é‡ç‚¹
- ä¸¤ä¸ªæŒ‡é’ˆ**åŒæ­¥èµ° 1 æ­¥**ï¼Œ**ç¬¬ä¸€æ¬¡ç›¸é‡å¤„å°±æ˜¯çŽ¯å…¥å£**

------

### ðŸ“ æ•°å­¦åŽŸç†ï¼ˆä¸ºä»€ä¹ˆè¿™æ ·èƒ½æ‰¾åˆ°å…¥å£ï¼Ÿï¼‰

è®¾é“¾è¡¨ç»“æž„å¦‚ä¸‹ï¼š

```
A â†’ B â†’ C â†’ D â†’ E
          â†‘     â†“
          G â† F â† 
```

- ä»Žå¤´åˆ°çŽ¯å…¥å£çš„è·ç¦»ï¼š**a**ï¼ˆå¦‚ Aâ†’Bâ†’Cï¼Œa=2ï¼‰
- ä»ŽçŽ¯å…¥å£åˆ°ç›¸é‡ç‚¹çš„è·ç¦»ï¼š**b**
- ä»Žç›¸é‡ç‚¹å›žåˆ°çŽ¯å…¥å£çš„è·ç¦»ï¼š**c**
- çŽ¯æ€»é•¿ï¼š**L = b + c**

å½“å¿«æ…¢æŒ‡é’ˆç›¸é‡æ—¶ï¼š

- æ…¢æŒ‡é’ˆèµ°äº†ï¼š`s = a + b`
- å¿«æŒ‡é’ˆèµ°äº†ï¼š`f = a + b + kÂ·L`ï¼ˆk â‰¥ 1ï¼Œç»•çŽ¯ k åœˆï¼‰
- åˆå›  `f = 2s`ï¼ˆå¿«æŒ‡é’ˆé€Ÿåº¦æ˜¯æ…¢çš„ 2 å€ï¼‰

ä»£å…¥å¾—ï¼š

```
2(a + b) = a + b + kL
â‡’ a + b = kL
â‡’ a = kL - b = (k - 1)L + (L - b) = (k - 1)L + c
```

> **ç»“è®º**ï¼šä»Žå¤´èŠ‚ç‚¹åˆ°å…¥å£çš„è·ç¦» `a`ï¼Œç­‰äºŽä»Žç›¸é‡ç‚¹æ²¿çŽ¯èµ° `c`ï¼ˆå³å›žåˆ°å…¥å£ï¼‰å†ç»•è‹¥å¹²æ•´åœˆã€‚

å› æ­¤ï¼š

- è®©ä¸€ä¸ªæŒ‡é’ˆä»Ž `head` å‡ºå‘ï¼Œå¦ä¸€ä¸ªä»Ž `ç›¸é‡ç‚¹` å‡ºå‘ï¼›
- ä¸¤è€…éƒ½èµ° `a` æ­¥åŽï¼Œ**å¿…ç„¶åœ¨çŽ¯å…¥å£ç›¸é‡**ï¼

âœ… è¿™å°±æ˜¯ç¬¬äºŒé˜¶æ®µçš„ç†è®ºä¾æ®ã€‚

------

### ðŸ”„ ç¤ºä¾‹æ¼”ç¤º

é“¾è¡¨ï¼š`1 â†’ 2 â†’ 3 â†’ 4 â†’ 5 â†’ 3ï¼ˆçŽ¯å…¥å£æ˜¯ 3ï¼‰`

- a = 2ï¼ˆ1â†’2â†’3ï¼‰
- çŽ¯ï¼š3â†’4â†’5â†’3ï¼ŒL=3

å¿«æ…¢æŒ‡é’ˆå¯èƒ½åœ¨ `5` ç›¸é‡ï¼ˆb=2, c=1ï¼‰ï¼š

- slow: 1â†’2â†’3â†’4â†’5ï¼ˆèµ°äº† 4 æ­¥ = a+b = 2+2ï¼‰
- fast: 1â†’3â†’5â†’4â†’5ï¼ˆèµ°äº† 8 æ­¥ = 2Ã—4ï¼‰

ç„¶åŽï¼š

- ptr1 = head = 1
- ptr2 = slow = 5

åŒæ­¥èµ°ï¼š

- ptr1: 1 â†’ 2 â†’ 3
- ptr2: 5 â†’ 3 â†’ 4

åœ¨ç¬¬ 2 æ­¥ï¼Œä¸¤è€…éƒ½åœ¨ `3` â†’ è¿”å›ž `3` âœ…

------

### â±ï¸ å¤æ‚åº¦åˆ†æžï¼š

- æ—¶é—´å¤æ‚åº¦ï¼šO(n)
    - ç¬¬ä¸€é˜¶æ®µæœ€å¤šèµ° a + L æ­¥
    - ç¬¬äºŒé˜¶æ®µèµ° a æ­¥
- ç©ºé—´å¤æ‚åº¦ï¼šO(1)
    - ä»…ç”¨ä¸¤ä¸ªæŒ‡é’ˆ

------

## ðŸ“š ç¬”è®°æ€»ç»“

### ðŸ§© æ ¸å¿ƒæ€æƒ³ï¼š

> **Floyd åˆ¤åœˆç®—æ³•ï¼ˆä¸¤é˜¶æ®µï¼‰**

### âœ… ç®—æ³•æ­¥éª¤ï¼š

1. é˜¶æ®µä¸€ï¼ˆåˆ¤çŽ¯ï¼‰ï¼š
    - å¿«æ…¢æŒ‡é’ˆåŒèµ·ç‚¹ï¼Œ`fast` èµ° 2 æ­¥ï¼Œ`slow` èµ° 1 æ­¥ï¼›
    - è‹¥ç›¸é‡ â†’ æœ‰çŽ¯ï¼›å¦åˆ™æ— çŽ¯ï¼Œè¿”å›ž `null`ã€‚
2. é˜¶æ®µäºŒï¼ˆæ‰¾å…¥å£ï¼‰ï¼š
    - ä¸€ä¸ªæŒ‡é’ˆé‡ç½®åˆ° `head`ï¼Œå¦ä¸€ä¸ªç•™åœ¨ç›¸é‡ç‚¹ï¼›
    - ä¸¤è€…åŒæ­¥èµ° 1 æ­¥ï¼Œ**é¦–æ¬¡ç›¸é‡å³ä¸ºçŽ¯å…¥å£**ã€‚

### ðŸ”‘ å…³é”®æ•°å­¦ç»“è®ºï¼š

> è®¾å¤´åˆ°å…¥å£è·ç¦»ä¸º `a`ï¼Œç›¸é‡ç‚¹åˆ°å…¥å£è·ç¦»ä¸º `c`ï¼Œåˆ™ `a = c + kÂ·L`
> â‡’ ä»Ž `head` å’Œ `ç›¸é‡ç‚¹` åŒæ­¥å‡ºå‘ï¼Œå¿…åœ¨å…¥å£ç›¸é‡ã€‚

### â±ï¸ å¤æ‚åº¦ï¼š

- æ—¶é—´ï¼šO(n)
- ç©ºé—´ï¼šO(1)

### ðŸ’¡ å¯¹æ¯”ï¼š

- **LeetCode 141ï¼ˆçŽ¯å½¢é“¾è¡¨ Iï¼‰**ï¼šåªéœ€åˆ¤çŽ¯ â†’ é˜¶æ®µä¸€å³å¯ï¼›
- **LeetCode 142ï¼ˆæœ¬é¢˜ï¼‰**ï¼šéœ€è¿”å›žå…¥å£ â†’ å¿…é¡»ä¸¤é˜¶æ®µã€‚

------

# ä¸‰ã€ä»£ç æ¼”ç¤º

## Javaä»£ç 

```Java
/**
 * Definition for singly-linked list.
 * class ListNode {
 *     int val;
 *     ListNode next;
 *     ListNode(int x) {
 *         val = x;
 *         next = null;
 *     }
 * }
 */
public class Solution {
    public ListNode detectCycle(ListNode head) {
        ListNode fast = head;
        ListNode slow = head;
        while (fast != null && fast.next != null) {
            slow = slow.next;
            fast = fast.next.next;
            if (fast == slow) {
                while (slow != head) {
                    slow = slow.next;
                    head = head.next;
                }
                return slow;
            }
        }
        return null;
    }
}
```

![142_çŽ¯å½¢é“¾è¡¨ II_Java]()

## Pythonä»£ç 

```python
# Definition for singly-linked list.
# class ListNode:
#     def __init__(self, x):
#         self.val = x
#         self.next = None

class Solution:
    def detectCycle(self, head: Optional[ListNode]) -> Optional[ListNode]:
        slow = fast = head
        while fast and fast.next:
            slow = slow.next
            fast = fast.next.next
            if fast == slow:
                while slow is not head:
                    slow = slow.next
                    head = head.next
                return slow
        return None
```



## C++ä»£ç 

```C++
/**
 * Definition for singly-linked list.
 * struct ListNode {
 *     int val;
 *     ListNode *next;
 *     ListNode(int x) : val(x), next(NULL) {}
 * };
 */
class Solution {
public:
    ListNode *detectCycle(ListNode *head) {
        ListNode* fast = head;
        ListNode* slow = head;
        while (fast && fast->next) {
            slow = slow->next;
            fast = fast->next->next;
            if (fast == slow) {
                while (slow != head) {
                    slow = slow->next;
                    head = head->next;
                }
                return slow;
            }
        }
        return NULL;
    }
};
```

