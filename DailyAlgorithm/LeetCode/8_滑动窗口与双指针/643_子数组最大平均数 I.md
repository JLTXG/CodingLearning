[643. å­æ•°ç»„æœ€å¤§å¹³å‡æ•° I - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/maximum-average-subarray-i/description/)

>æ ‡ç­¾ï¼šæ•°ç»„  |  æ»‘åŠ¨çª—å£

# ä¸€ã€é¢˜ç›®æè¿°

ç»™ä½ ä¸€ä¸ªç”± `n` ä¸ªå…ƒç´ ç»„æˆçš„æ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªæ•´æ•° `k` ã€‚

è¯·ä½ æ‰¾å‡ºå¹³å‡æ•°æœ€å¤§ä¸” **é•¿åº¦ä¸º `k`** çš„è¿ç»­å­æ•°ç»„ï¼Œå¹¶è¾“å‡ºè¯¥æœ€å¤§å¹³å‡æ•°ã€‚

ä»»ä½•è¯¯å·®å°äº `10-5` çš„ç­”æ¡ˆéƒ½å°†è¢«è§†ä¸ºæ­£ç¡®ç­”æ¡ˆã€‚

 

**ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥ï¼šnums = [1,12,-5,-6,50,3], k = 4
è¾“å‡ºï¼š12.75
è§£é‡Šï¼šæœ€å¤§å¹³å‡æ•° (12-5-6+50)/4 = 51/4 = 12.75
```

**ç¤ºä¾‹ 2ï¼š**

```
è¾“å…¥ï¼šnums = [5], k = 1
è¾“å‡ºï¼š5.00000
```

 

**æç¤ºï¼š**

- `n == nums.length`
- `1 <= k <= n <= 10^5`
- `-10^4 <= nums[i] <= 10^4`



# äºŒã€è§£é¢˜æ€è·¯\è§£é¢˜è¿‡ç¨‹

## è§£é¢˜è¿‡ç¨‹

è¿™æ˜¯çµç¥æä¾›çš„æ»‘åŠ¨çª—å£é¢˜å•ï¼ˆ[åˆ†äº«ä¸¨ã€ç®—æ³•é¢˜å•ã€‘æ»‘åŠ¨çª—å£ä¸åŒæŒ‡é’ˆï¼ˆå®šé•¿/ä¸å®šé•¿/å•åºåˆ—/åŒåºåˆ—/ä¸‰æŒ‡é’ˆ/åˆ†ç»„å¾ªç¯ï¼‰ - è®¨è®º - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/discuss/post/3578981/ti-dan-hua-dong-chuang-kou-ding-chang-bu-rzz7/)ï¼‰ä¸­çš„ç¬¬äºŒé¢˜ï¼Œè¿™é“é¢˜çš„éš¾åº¦æ˜¯ç®€å•çº§åˆ«çš„ï¼ŒåŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é‡‡ç”¨çµç¥æ€»ç»“å‡ºçš„æ»‘åŠ¨çª—å£é¢˜ç›®çš„ç»å…¸åšæ³•ï¼Œå¦‚ä¸‹ï¼š

çª—å£å³ç«¯ç‚¹åœ¨`i`æ—¶ï¼Œç”±äºçª—å£é•¿åº¦ä¸º`k`ï¼Œæ‰€ä»¥çª—å£åœ¨å·¦ç«¯ç‚¹ä¸º`i - k + 1`ã€‚

ä¸€å…±æœ‰ä¸‰æ­¥ï¼š**å…¥â€”â€”æ›´æ–°â€”â€”å‡º**ã€‚

1. **å…¥**ï¼šä¸‹æ ‡ä¸º`i`çš„å…ƒç´ è¿›å…¥çª—å£ï¼Œæ›´æ–°ç›¸å…³ç»Ÿè®¡é‡ã€‚å¦‚æœçª—å£å·¦ç«¯ç‚¹`i - k + 1 < 0`ï¼Œåˆ™å°šæœªå½¢æˆç¬¬ä¸€ä¸ªçª—å£ï¼Œé‡å¤ç¬¬ä¸€æ­¥ã€‚
2. **æ›´æ–°**ï¼šæ›´æ–°ç­”æ¡ˆã€‚ä¸€èˆ¬æ˜¯æ›´æ–°æœ€å¤§å€¼/æœ€å°å€¼ã€‚
3. **å‡º**ï¼šä¸‹æ ‡ä¸º`i - k + 1`çš„å…ƒç´ ç¦»å¼€çª—å£ï¼Œæ›´æ–°ç›¸å…³ç»Ÿè®¡é‡ï¼Œä¸ºä¸‹ä¸€ä¸ªå¾ªç¯åšå‡†å¤‡ã€‚

æœ¬é¢˜å…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š

```cpp
class Solution {
public:
    double findMaxAverage(vector<int>& nums, int k) {
        double result = -INFINITY, count = 0;
        int n = nums.size();
        for (int i = 0; i < n; i++) {
            // å…¥
            count += nums[i];
            // æ›´æ–°ç­”æ¡ˆ
            int left = i - k + 1;
            if (left < 0) {
                // å·¦ç«¯ç‚¹è¿˜æ²¡æœ‰è¿›å…¥çª—å£ï¼Œè·³è¿‡æœ¬æ¬¡å¾ªç¯
                continue;
            }
            result = max(result, count / k);
            // å‡º
            count -= nums[left];
        }
        return result;
    }
};
```

## çŸ¥è¯†è¡¥å……
### ğŸ§® ä¸€ã€Java

#### âœ… æ•´æ•°ç±»å‹ï¼ˆæœ‰ç¬¦å·ï¼Œè¡¥ç è¡¨ç¤ºï¼‰

| ç±»å‹    | æœ€å¤§å€¼ï¼ˆMAX_VALUEï¼‰          | æœ€å°å€¼ï¼ˆMIN_VALUEï¼‰           | ä½æ•° |
| ------- | ---------------------------- | ----------------------------- | ---- |
| `byte`  | `127`                        | `-128`                        | 8    |
| `short` | `32_767`                     | `-32_768`                     | 16   |
| `int`   | `2_147_483_647`              | `-2_147_483_648`              | 32   |
| `long`  | `9_223_372_036_854_775_807L` | `-9_223_372_036_854_775_808L` | 64   |

> ğŸ”¸ æ‰€æœ‰æ•´æ•°ç±»å‹**æ²¡æœ‰â€œæœ€å°æ­£éé›¶å€¼â€æ¦‚å¿µ**ï¼ˆæœ€å°æ­£æ•´æ•°å°±æ˜¯ 1ï¼‰  
> ğŸ”¸ **æ²¡æœ‰æ— ç©·å¤§**ï¼ˆæ•´æ•°æº¢å‡ºæ˜¯æœªå®šä¹‰è¡Œä¸ºï¼Œä½† Java ä¼šé™é»˜å›ç»•ï¼‰

---

#### âœ… æµ®ç‚¹ç±»å‹ï¼ˆIEEE 754ï¼‰

| å¸¸é‡                       | å«ä¹‰                          | å€¼ï¼ˆè¿‘ä¼¼ï¼‰                |
| -------------------------- | ----------------------------- | ------------------------- |
| `Float.MAX_VALUE`          | æœ€å¤§æ­£æœ‰é™ float              | `3.4028235e38`            |
| `Double.MAX_VALUE`         | æœ€å¤§æ­£æœ‰é™ double             | `1.7976931348623157e308`  |
| `-Float.MAX_VALUE`         | æœ€å°ï¼ˆæœ€è´Ÿï¼‰æœ‰é™ float        | `-3.4028235e38`           |
| `-Double.MAX_VALUE`        | æœ€å°ï¼ˆæœ€è´Ÿï¼‰æœ‰é™ double       | `-1.7976931348623157e308` |
| `Float.MIN_VALUE`          | æœ€å°æ­£éé›¶ floatï¼ˆéæ­£è§„æ•°ï¼‰  | `1.4e-45`                 |
| `Double.MIN_VALUE`         | æœ€å°æ­£éé›¶ doubleï¼ˆéæ­£è§„æ•°ï¼‰ | `4.9e-324`                |
| `Float.POSITIVE_INFINITY`  | æ­£æ— ç©·                        | `+âˆ`                      |
| `Double.NEGATIVE_INFINITY` | è´Ÿæ— ç©·                        | `-âˆ`                      |
| `Float.NaN` / `Double.NaN` | éæ•°                          | `NaN`                     |

> âš ï¸ **å…³é”®æé†’**ï¼š
>
> - `Double.MIN_VALUE` æ˜¯**æ­£æ•°**ï¼ä¸æ˜¯â€œæœ€å°çš„ doubleâ€
> - çœŸæ­£çš„â€œæœ€å° double å€¼â€æ˜¯ `-Double.MAX_VALUE`

---

### ğŸ§® äºŒã€C++

éœ€è¦åŒ…å«å¤´æ–‡ä»¶ï¼š

- `<climits>` æˆ– `<limits>`ï¼ˆæ¨èåè€…ï¼‰
- `<cfloat>`ï¼ˆC é£æ ¼ï¼Œä¸æ¨èæ–°ä»£ç ä½¿ç”¨ï¼‰

#### âœ… æ•´æ•°ç±»å‹ï¼ˆå®ç°ç›¸å…³ï¼Œä½†é€šå¸¸å¦‚ä¸‹ï¼‰

| ç±»å‹        | æœ€å¤§å€¼                       | æœ€å°å€¼                   | è·å–æ–¹å¼ï¼ˆ`<limits>`ï¼‰             |
| ----------- | ---------------------------- | ------------------------ | ---------------------------------- |
| `char`      | `127`ï¼ˆè‹¥ signedï¼‰           | `-128`                   | `numeric_limits<char>::max()`      |
| `short`     | `32767`                      | `-32768`                 | `numeric_limits<short>::min()`     |
| `int`       | `2147483647`                 | `-2147483648`            | `numeric_limits<int>::max()`       |
| `long`      | â‰¥ `2147483647`ï¼ˆé€šå¸¸ 64 ä½ï¼‰ | â‰¤ `-2147483648`          | `numeric_limits<long>::min()`      |
| `long long` | `9223372036854775807LL`      | `-9223372036854775808LL` | `numeric_limits<long long>::min()` |

> ğŸ”¸ ä½¿ç”¨ `std::numeric_limits<T>::max()` å’Œ `min()` æ˜¯æ ‡å‡†æ–¹å¼  
> ğŸ”¸ `min()` å¯¹æœ‰ç¬¦å·æ•´æ•°è¿”å›çš„æ˜¯**è´Ÿæ•°**ï¼ˆå¦‚ `int` çš„ `min() = -2147483648`ï¼‰

---

#### âœ… æµ®ç‚¹ç±»å‹ï¼ˆIEEE 754ï¼‰

| è¡¨è¾¾å¼                                      | å«ä¹‰                        | ç¤ºä¾‹å€¼         |
| ------------------------------------------- | --------------------------- | -------------- |
| `std::numeric_limits<double>::max()`        | æœ€å¤§æ­£æœ‰é™å€¼                | `1.79769e308`  |
| `-std::numeric_limits<double>::max()`       | æœ€å°ï¼ˆæœ€è´Ÿï¼‰æœ‰é™å€¼          | `-1.79769e308` |
| `std::numeric_limits<double>::min()`        | **æœ€å°æ­£è§„æ­£æ•°**ï¼ˆâš ï¸æ³¨æ„ï¼ï¼‰ | `2.22507e-308` |
| `std::numeric_limits<double>::denorm_min()` | æœ€å°æ­£éé›¶å€¼ï¼ˆå«éæ­£è§„æ•°ï¼‰  | `4.9e-324`     |
| `-INFINITY`ï¼ˆéœ€ `<cmath>`ï¼‰                 | è´Ÿæ— ç©·                      | `-inf`         |
| `INFINITY`                                  | æ­£æ— ç©·                      | `+inf`         |
| `NAN`                                       | éæ•°                        | `nan`          |

> âš ï¸ **é‡è¦åŒºåˆ«**ï¼š
>
> - `numeric_limits<double>::min()` â‰  æœ€å°æ­£éé›¶å€¼ï¼  
>     å®ƒæ˜¯**æœ€å°æ­£è§„æ­£æ•°**ï¼ˆnormal numberï¼‰ï¼Œæ¯” `denorm_min()` å¤§
> - çœŸæ­£å¯¹åº” Java `Double.MIN_VALUE` çš„æ˜¯ `denorm_min()`

---

### ğŸ§® ä¸‰ã€Python

Python çš„æ•´æ•°æ˜¯**ä»»æ„ç²¾åº¦**ï¼ˆæ— æº¢å‡ºï¼‰ï¼Œæ‰€ä»¥**æ²¡æœ‰æœ€å¤§/æœ€å°æ•´æ•°å€¼**ã€‚

```python
# æ•´æ•°å¯ä»¥æ— é™å¤§
x = 10**1000  # åˆæ³•ï¼
```

å› æ­¤ï¼Œåªå…³æ³¨**æµ®ç‚¹æ•°**ï¼ˆ`float`ï¼ŒåŸºäº C doubleï¼Œå³ IEEE 754 64 ä½ï¼‰

#### âœ… æµ®ç‚¹ç±»å‹ï¼ˆ`float`ï¼‰

| è¡¨è¾¾å¼                         | å«ä¹‰                                 | å€¼ï¼ˆè¿‘ä¼¼ï¼‰                 |
| ------------------------------ | ------------------------------------ | -------------------------- |
| `float('inf')` æˆ– `math.inf`   | æ­£æ— ç©·                               | `inf`                      |
| `float('-inf')` æˆ– `-math.inf` | è´Ÿæ— ç©·                               | `-inf`                     |
| `sys.float_info.max`           | æœ€å¤§æ­£æœ‰é™å€¼                         | `1.7976931348623157e+308`  |
| `-sys.float_info.max`          | æœ€å°ï¼ˆæœ€è´Ÿï¼‰æœ‰é™å€¼                   | `-1.7976931348623157e+308` |
| `sys.float_info.min`           | **æœ€å°æ­£è§„æ­£æ•°**                     | `2.2250738585072014e-308`  |
| `sys.float_info.epsilon`       | æœºå™¨ epsilonï¼ˆ1 ä¸ä¸‹ä¸€ä¸ªæµ®ç‚¹æ•°ä¹‹å·®ï¼‰ | `2.220446049250313e-16`    |
| æœ€å°æ­£éé›¶å€¼ï¼ˆéæ­£è§„ï¼‰         | æ— ç›´æ¥å¸¸é‡ï¼Œä½†å¯è®¡ç®—                 | â‰ˆ `5e-324`                 |

> ğŸ”¸ è·å–æ–¹å¼ï¼š
>
> ```python
> import sys, math
> print(sys.float_info.max)      # 1.797...e308
> print(sys.float_info.min)      # 2.225...e-308 ï¼ˆæ­£è§„æ•°ï¼‰
> print(float('-inf'))           # -inf
> ```

> âš ï¸ æ³¨æ„ï¼š`sys.float_info.min` æ˜¯**æ­£è§„æœ€å°æ­£æ•°**ï¼Œä¸æ˜¯ç»å¯¹æœ€å°æ­£æ•°ï¼ˆéæ­£è§„æ•°æ›´å°ï¼‰

---

### ğŸ“Š å¿«é€Ÿå¯¹æ¯”è¡¨ï¼ˆæµ®ç‚¹å…³é”®å¸¸é‡ï¼‰

| è¯­è¨€       | æœ€å¤§æ­£æœ‰é™å€¼                    | æœ€å°ï¼ˆæœ€è´Ÿï¼‰æœ‰é™å€¼    | æœ€å°æ­£éé›¶å€¼                    | è´Ÿæ— ç©·                     |
| ---------- | ------------------------------- | --------------------- | ------------------------------- | -------------------------- |
| **Java**   | `Double.MAX_VALUE`              | `-Double.MAX_VALUE`   | `Double.MIN_VALUE` (`4.9e-324`) | `Double.NEGATIVE_INFINITY` |
| **C++**    | `numeric_limits<double>::max()` | `-max()`              | `denorm_min()` (`4.9e-324`)     | `-INFINITY`                |
| **Python** | `sys.float_info.max`            | `-sys.float_info.max` | â‰ˆ`5e-324`ï¼ˆæ— ç›´æ¥å¸¸é‡ï¼‰         | `float('-inf')`            |

#### å¦‚ä½•è¡¨ç¤ºPythonä¸­æ•´æ•°çš„â€œæœ€å¤§/æœ€å°å€¼â€

| ç›®çš„                      | æ¨èæ–¹å¼                            | è¯´æ˜                         |
| ------------------------- | ----------------------------------- | ---------------------------- |
| ç®—æ³•åˆå§‹åŒ–ï¼ˆæ‰¾æœ€å¤§/æœ€å°ï¼‰ | `float('-inf')` / `float('inf')`    | æœ€ç®€å•ã€æœ€å®‰å…¨               |
| æ¨¡æ‹Ÿ C/Java çš„ int èŒƒå›´   | `sys.maxsize` å’Œ `-sys.maxsize - 1` | é€‚ç”¨äºéœ€è¦â€œæœ‰é™å¤§æ•´æ•°â€çš„åœºæ™¯ |
| çœŸæ­£æœ€å¤§æ•´æ•°              | ä¸å­˜åœ¨                              | Python int æ— ç•Œ              |

> ğŸ”¸ Java çš„ `Double.MIN_VALUE` â‰ˆ C++ çš„ `denorm_min()` â‰ˆ Python çš„æœ€å°éæ­£è§„æ­£æ•°

---

### âœ… ç¼–ç¨‹å»ºè®®

1. **åˆå§‹åŒ–æœ€å¤§/æœ€å°å€¼æ—¶**ï¼š
   
    - æ•´æ•°ï¼šç”¨ `INT_MIN` / `Integer.MIN_VALUE` ç­‰
    - æµ®ç‚¹æ‰¾æœ€å¤§å€¼ï¼šç”¨ `-inf`ï¼ˆ`Double.NEGATIVE_INFINITY`, `float('-inf')`, `-INFINITY`ï¼‰
    - æµ®ç‚¹æ‰¾æœ€å°å€¼ï¼šç”¨ `+inf`
2. **ä¸è¦æ··æ·†**ï¼š
   
    - `Double.MIN_VALUE`ï¼ˆJavaï¼‰â‰  æœ€å° double å€¼ âŒ
    - `numeric_limits<double>::min()`ï¼ˆC++ï¼‰â‰  æœ€å°æ­£ double å€¼ âŒï¼ˆå®ƒæ˜¯æ­£è§„æ•°ä¸‹ç•Œï¼‰
3. **Python æ•´æ•°æ— ç•Œ**ï¼Œä½† `float` æœ‰ç•Œï¼Œæ³¨æ„ç±»å‹ï¼

---



# ä¸‰ã€ä»£ç æ¼”ç¤º

## Javaä»£ç 

```Java
class Solution {
    public double findMaxAverage(int[] nums, int k) {
        double result = Double.NEGATIVE_INFINITY, count = 0;
        int n = nums.length;
        for (int i = 0; i < n; i++) {
            // å…¥
            count += nums[i];
            // æ›´æ–°ç­”æ¡ˆ
            int left = i - k + 1;
            if (left < 0) {
                // å·¦ç«¯ç‚¹è¿˜æ²¡æœ‰è¿›å…¥çª—å£ï¼Œè·³è¿‡æœ¬æ¬¡å¾ªç¯
                continue;
            }
            result = Math.max(result, count / k);
            // å‡º
            count -= nums[left];
        }
        return result;
    }
}
```



## Pythonä»£ç 

```Python
class Solution:
    def findMaxAverage(self, nums: List[int], k: int) -> float:
        result, count, n = -math.inf, 0, len(nums)
        for i in range(n):
            # å…¥
            # å³ç«¯ç‚¹è¿›å…¥çª—å£
            count += nums[i]

            # æ›´æ–°ç­”æ¡ˆ
            left = i - k + 1
            if left < 0 :
                # è¯´æ˜æ­¤æ—¶å·¦ç«¯ç‚¹è¿˜æ²¡æœ‰è¿›å…¥çª—å£
                continue
            
            result = max(result, count)

            # å‡º
            count -= nums[left]
        return result / k
```



## C++ä»£ç 

```C++
class Solution {
public:
    double findMaxAverage(vector<int>& nums, int k) {
        double result = -INFINITY, count = 0;
        int n = nums.size();
        for (int i = 0; i < n; i++) {
            // å…¥
            count += nums[i];
            // æ›´æ–°ç­”æ¡ˆ
            int left = i - k + 1;
            if (left < 0) {
                // å·¦ç«¯ç‚¹è¿˜æ²¡æœ‰è¿›å…¥çª—å£ï¼Œè·³è¿‡æœ¬æ¬¡å¾ªç¯
                continue;
            }
            result = max(result, count / k);
            // å‡º
            count -= nums[left];
        }
        return result;
    }
};
```

![643_å­æ•°ç»„æœ€å¤§å¹³å‡æ•° I_C++](https://gitee.com/lei-weijun/CodingLearning/raw/main/DailyAlgorithm/LeetCode/8_%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E4%B8%8E%E5%8F%8C%E6%8C%87%E9%92%88/Images/643_%E5%AD%90%E6%95%B0%E7%BB%84%E6%9C%80%E5%A4%A7%E5%B9%B3%E5%9D%87%E6%95%B0%20I_C++.png)