[236. äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/lowest-common-ancestor-of-a-binary-tree/description/)

>æ ‡ç­¾ï¼šæ ‘  |  æ·±åº¦ä¼˜å…ˆæœç´¢  |  äºŒå‰æ ‘

# ä¸€ã€é¢˜ç›®æè¿°

![236_äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ_æƒ…å†µè®¨è®º](https://gitee.com/lei-weijun/CodingLearning/raw/main/DailyAlgorithm/LeetCode/11_%E6%A0%91%E4%B8%8E%E4%BA%8C%E5%8F%89%E6%A0%91/Images/236_%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88_%E6%83%85%E5%86%B5%E8%AE%A8%E8%AE%BA.png)

ç»™å®šä¸€ä¸ªäºŒå‰æ ‘, æ‰¾åˆ°è¯¥æ ‘ä¸­ä¸¤ä¸ªæŒ‡å®šèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚

[ç™¾åº¦ç™¾ç§‘](https://baike.baidu.com/item/æœ€è¿‘å…¬å…±ç¥–å…ˆ/8918834?fr=aladdin)ä¸­æœ€è¿‘å…¬å…±ç¥–å…ˆçš„å®šä¹‰ä¸ºï¼šâ€œå¯¹äºæœ‰æ ¹æ ‘ T çš„ä¸¤ä¸ªèŠ‚ç‚¹ pã€qï¼Œæœ€è¿‘å…¬å…±ç¥–å…ˆè¡¨ç¤ºä¸ºä¸€ä¸ªèŠ‚ç‚¹ xï¼Œæ»¡è¶³ x æ˜¯ pã€q çš„ç¥–å…ˆä¸” x çš„æ·±åº¦å°½å¯èƒ½å¤§ï¼ˆ**ä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå¯ä»¥æ˜¯å®ƒè‡ªå·±çš„ç¥–å…ˆ**ï¼‰ã€‚â€

 

**ç¤ºä¾‹ 1ï¼š**

![img](https://gitee.com/lei-weijun/CodingLearning/raw/main/DailyAlgorithm/LeetCode/11_%E6%A0%91%E4%B8%8E%E4%BA%8C%E5%8F%89%E6%A0%91/Images/236_%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88_%E7%A4%BA%E4%BE%8B1.png)

```
è¾“å…¥ï¼šroot = [3,5,1,6,2,0,8,null,null,7,4], p = 5, q = 1
è¾“å‡ºï¼š3
è§£é‡Šï¼šèŠ‚ç‚¹ 5 å’ŒèŠ‚ç‚¹ 1 çš„æœ€è¿‘å…¬å…±ç¥–å…ˆæ˜¯èŠ‚ç‚¹ 3 ã€‚
```

**ç¤ºä¾‹ 2ï¼š**

![img](https://gitee.com/lei-weijun/CodingLearning/raw/main/DailyAlgorithm/LeetCode/11_%E6%A0%91%E4%B8%8E%E4%BA%8C%E5%8F%89%E6%A0%91/Images/236_%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88_%E7%A4%BA%E4%BE%8B2.png)

```
è¾“å…¥ï¼šroot = [3,5,1,6,2,0,8,null,null,7,4], p = 5, q = 4
è¾“å‡ºï¼š5
è§£é‡Šï¼šèŠ‚ç‚¹ 5 å’ŒèŠ‚ç‚¹ 4 çš„æœ€è¿‘å…¬å…±ç¥–å…ˆæ˜¯èŠ‚ç‚¹ 5 ã€‚å› ä¸ºæ ¹æ®å®šä¹‰æœ€è¿‘å…¬å…±ç¥–å…ˆèŠ‚ç‚¹å¯ä»¥ä¸ºèŠ‚ç‚¹æœ¬èº«ã€‚
```

**ç¤ºä¾‹ 3ï¼š**

```
è¾“å…¥ï¼šroot = [1,2], p = 1, q = 2
è¾“å‡ºï¼š1
```

 

**æç¤ºï¼š**

- æ ‘ä¸­èŠ‚ç‚¹æ•°ç›®åœ¨èŒƒå›´ `[2, 105]` å†…ã€‚
- `-109 <= Node.val <= 109`
- æ‰€æœ‰ `Node.val` `äº’ä¸ç›¸åŒ` ã€‚
- `p != q`
- `p` å’Œ `q` å‡å­˜åœ¨äºç»™å®šçš„äºŒå‰æ ‘ä¸­ã€‚



# äºŒã€è§£é¢˜æ€è·¯\è§£é¢˜è¿‡ç¨‹

## ğŸ” é¢˜ç›®ç†è§£

ç»™å®šä¸€æ£µ**æ™®é€šäºŒå‰æ ‘**ï¼ˆä¸æ˜¯ BSTï¼‰å’Œä¸¤ä¸ªèŠ‚ç‚¹ `p` å’Œ `q`ï¼Œè¦æ±‚è¿”å›å®ƒä»¬çš„**æœ€è¿‘å…¬å…±ç¥–å…ˆ**ï¼ˆLCAï¼‰ã€‚

- **æœ€è¿‘å…¬å…±ç¥–å…ˆ**ï¼šæŒ‡åœ¨æ‰€æœ‰åŒæ—¶æ˜¯ `p` å’Œ `q` ç¥–å…ˆçš„èŠ‚ç‚¹ä¸­ï¼Œ**æ·±åº¦æœ€å¤§**çš„é‚£ä¸ªã€‚
- ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥æ˜¯å®ƒè‡ªå·±çš„ç¥–å…ˆï¼ˆä¾‹å¦‚å½“ `p` æ˜¯ `q` çš„ç¥–å…ˆæ—¶ï¼Œç­”æ¡ˆå°±æ˜¯ `p`ï¼‰ã€‚
- é¢˜ç›®ä¿è¯ `p` å’Œ `q` ä¸€å®šå­˜åœ¨äºæ ‘ä¸­ã€‚
## ğŸ’¡ è§£é¢˜æ€è·¯è¯¦è§£

è¯¥ç®—æ³•é‡‡ç”¨**é€’å½’ + ååºéå†**çš„æ€æƒ³ï¼Œæ ¸å¿ƒåœ¨äºï¼š**è‡ªåº•å‘ä¸Šåœ°åˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯å¦ä¸ºæœ€è¿‘å…¬å…±ç¥–å…ˆ**ã€‚
### æ ¸å¿ƒé€»è¾‘ï¼š

1. **é€’å½’ç»ˆæ­¢æ¡ä»¶**ï¼š
    - å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯ `null`ï¼Œè¯´æ˜å·²åˆ°å¶å­ä¸‹æ–¹ï¼Œè¿”å› `null`ã€‚
    - å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯ `p` æˆ– `q`ï¼Œç›´æ¥è¿”å›è¯¥èŠ‚ç‚¹ã€‚è¿™æ—¢è¡¨ç¤ºâ€œæ‰¾åˆ°äº†ç›®æ ‡â€ï¼Œä¹Ÿå¤„ç†äº†â€œä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦ä¸€ä¸ªèŠ‚ç‚¹ç¥–å…ˆâ€çš„ç‰¹æ®Šæƒ…å†µã€‚
2. **é€’å½’å·¦å³å­æ ‘**ï¼š
    - åœ¨å·¦å­æ ‘ä¸­æŸ¥æ‰¾ `p` æˆ– `q`ï¼Œå¾—åˆ°ç»“æœ `left`ã€‚
    - åœ¨å³å­æ ‘ä¸­æŸ¥æ‰¾ `p` æˆ– `q`ï¼Œå¾—åˆ°ç»“æœ `right`ã€‚
3. **åˆå¹¶ç»“æœï¼ˆå…³é”®åˆ¤æ–­ï¼‰**ï¼š
    - **æƒ…å†µä¸€**ï¼š`left != null && right != null`  
        è¯´æ˜ `p` å’Œ `q` åˆ†åˆ«ä½äºå½“å‰èŠ‚ç‚¹çš„**å·¦å³ä¸¤ä¾§**ï¼Œé‚£ä¹ˆå½“å‰èŠ‚ç‚¹ `root` å°±æ˜¯å®ƒä»¬çš„**æœ€è¿‘å…¬å…±ç¥–å…ˆ**ã€‚
    - **æƒ…å†µäºŒ**ï¼šåªæœ‰ä¸€ä¾§éç©ºï¼ˆå¦‚ `left != null`ï¼‰  
        è¯´æ˜ `p` å’Œ `q` éƒ½åœ¨**åŒä¸€ä¾§å­æ ‘ä¸­**ï¼Œé‚£ä¹ˆæœ€è¿‘å…¬å…±ç¥–å…ˆä¸€å®šåœ¨é‚£ä¸€ä¾§ï¼Œç›´æ¥è¿”å›è¯¥ä¾§ç»“æœã€‚
    - **æƒ…å†µä¸‰**ï¼šä¸¤ä¾§éƒ½ä¸ºç©ºï¼ˆç†è®ºä¸Šä¸ä¼šå‘ç”Ÿï¼Œå› é¢˜ç›®ä¿è¯ pã€q å­˜åœ¨ï¼‰
### ä¸ºä»€ä¹ˆæ­£ç¡®ï¼Ÿ
- ç”±äºæ˜¯**ååºéå†**ï¼ˆå…ˆå­æ ‘ï¼Œåæ ¹ï¼‰ï¼Œå½“å›æº¯åˆ°æŸä¸ªèŠ‚ç‚¹æ—¶ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“å·¦å³å­æ ‘æ˜¯å¦åŒ…å« `p` æˆ– `q`ã€‚
- ä¸€æ—¦å‘ç° `p` å’Œ `q` â€œåˆ†å®¶â€ï¼ˆåˆ†åˆ«åœ¨å·¦å³å­æ ‘ï¼‰ï¼Œè¿™ä¸ªâ€œåˆ†å®¶ç‚¹â€å°±æ˜¯æœ€è¿‘çš„å…¬å…±ç¥–å…ˆã€‚
- å¦‚æœæ²¡åˆ†å®¶ï¼Œå°±ç»§ç»­æŠŠæ‰¾åˆ°çš„èŠ‚ç‚¹ï¼ˆæˆ–å­æ ‘çš„ LCAï¼‰å‘ä¸Šä¼ é€’ã€‚
### å¤æ‚åº¦åˆ†æï¼š
- **æ—¶é—´å¤æ‚åº¦**ï¼šO(n)ï¼Œæœ€åéå†æ‰€æœ‰èŠ‚ç‚¹ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼šO(h)ï¼Œh ä¸ºæ ‘é«˜ï¼ˆé€’å½’æ ˆæ·±åº¦ï¼‰ã€‚
---
âœ… æ€»ç»“ï¼š  
è¿™æ®µä»£ç é€šè¿‡ä¸€æ¬¡ç®€æ´çš„é€’å½’ï¼Œå·§å¦™åˆ©ç”¨è¿”å›å€¼ä¼ é€’â€œæ˜¯å¦æ‰¾åˆ°ç›®æ ‡â€å’Œâ€œLCA æ˜¯è°â€çš„åŒé‡ä¿¡æ¯ï¼Œé«˜æ•ˆè§£å†³äº†æ™®é€šäºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆé—®é¢˜ã€‚

## ğŸ§  æœ€ç»ˆä»£ç 
```cpp
/**
 * Definition for a binary tree node.
 * struct TreeNode {
 *     int val;
 *     TreeNode *left;
 *     TreeNode *right;
 *     TreeNode(int x) : val(x), left(NULL), right(NULL) {}
 * };
 */
class Solution {
public:
    TreeNode* lowestCommonAncestor(TreeNode* root, TreeNode* p, TreeNode* q) {
        if(root == NULL || root == p || root == q){
            return root;
        }
        TreeNode* left = lowestCommonAncestor(root->left, p, q);
        TreeNode* right = lowestCommonAncestor(root->right, p, q);
        if(left != NULL && right != NULL){
            return root;
        }
        if(left != NULL){
            return left;
        }
        return right;
    }
};
```

# ä¸‰ã€ä»£ç æ¼”ç¤º

## Javaä»£ç 

```java
/**
 * Definition for a binary tree node.
 * public class TreeNode {
 *     int val;
 *     TreeNode left;
 *     TreeNode right;
 *     TreeNode(int x) { val = x; }
 * }
 */
class Solution {
    public TreeNode lowestCommonAncestor(TreeNode root, TreeNode p, TreeNode q) {
        if(root == null || root == p || root == q){
            return root;
        }
        TreeNode left = lowestCommonAncestor(root.left, p, q);
        TreeNode right = lowestCommonAncestor(root.right, p, q);
        if(left != null && right != null){
            return root;
        }
        if(left != null){
            return left;
        }
        return right;
    }
}
```



## Pythonä»£ç 

```Python
# Definition for a binary tree node.
# class TreeNode:
#     def __init__(self, x):
#         self.val = x
#         self.left = None
#         self.right = None

class Solution:
    def lowestCommonAncestor(self, root: 'TreeNode', p: 'TreeNode', q: 'TreeNode') -> 'TreeNode':
        if root is None or root is p or root is q :
            return root
        left = self.lowestCommonAncestor(root.left, p, q)
        right = self.lowestCommonAncestor(root.right, p, q)
        if left and right :
            return root
        if left :
            return left
        return right
```



## C++ä»£ç 

```C++
/**
 * Definition for a binary tree node.
 * struct TreeNode {
 *     int val;
 *     TreeNode *left;
 *     TreeNode *right;
 *     TreeNode(int x) : val(x), left(NULL), right(NULL) {}
 * };
 */
class Solution {
public:
    TreeNode* lowestCommonAncestor(TreeNode* root, TreeNode* p, TreeNode* q) {
        if(root == NULL || root == p || root == q){
            return root;
        }
        TreeNode* left = lowestCommonAncestor(root->left, p, q);
        TreeNode* right = lowestCommonAncestor(root->right, p, q);
        if(left != NULL && right != NULL){
            return root;
        }
        if(left != NULL){
            return left;
        }
        return right;
    }
};
```

![236_äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ_C++](https://gitee.com/lei-weijun/CodingLearning/raw/main/DailyAlgorithm/LeetCode/11_%E6%A0%91%E4%B8%8E%E4%BA%8C%E5%8F%89%E6%A0%91/Images/236_%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88_C++.png)
